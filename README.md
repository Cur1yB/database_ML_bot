## Структура проекта

 - `models.py` - файл с моделями базы данных (создание структуры БД).
 - `populate_db.py `- скрипт для заполнения базы данных случайными данными с использованием Faker.
 - `bot_database.db` - файл базы данных SQLite с созданными таблицами и данными.
 - `README.md` - данный файл с описанием проекта и инструкциями.

### **Основные сущности:**

1. **Контакты (Contacts)**
   - Информация о клиентах.

2. **Сегменты (Segments)**
   - Группы контактов для таргетированной рассылки.

3. **Источники контактов (ContactSources)**
   - Определяет, откуда поступил контакт (CRM, ручная загрузка и т.д.).

4. **Мессенджеры (Messengers)**
   - Подключенные мессенджеры для коммуникации.

5. **Сценарии бота (BotScripts)**
   - Сценарии продаж, по которым обучен бот.

6. **Переписки (Conversations)**
   - История общения между ботом и клиентами.

7. **Сообщения (Messages)**
   - Отдельные сообщения в рамках переписки.

8. **Задачи (Tasks)**
   - Задачи, создаваемые при выявлении интереса.

9. **Интеграции (Integrations)**
   - Интеграции с CRM системами и мессенджерами.

10. **Пользователи (Users)**
    - Менеджеры, которым назначаются задачи.

---

### **Описание таблиц:**

#### **1. Contacts (Контакты)**

- `id` (PK)
- `name` - Имя контакта
- `phone` - Телефон
- `email` - Электронная почта
- `source_id` (FK) - Ссылка на источник контакта
- `segment_id` (FK) - Ссылка на сегмент
- `created_at`
- `updated_at`

#### **2. Segments (Сегменты)**

- `id` (PK)
- `name` - Название сегмента
- `description` - Описание
- `created_at`
- `updated_at`

#### **3. ContactSources (Источники контактов)**

- `id` (PK)
- `name` - Название источника (например, "Ручная загрузка", "AmoCRM")
- `integration_id` (FK) - Ссылка на интеграцию (если применимо)
- `created_at`
- `updated_at`

#### **4. Messengers (Мессенджеры)**

- `id` (PK)
- `name` - Название мессенджера (например, "ChatApp", "Umnico")
- `integration_id` (FK) - Ссылка на интеграцию
- `is_active` - Статус активности
- `created_at`
- `updated_at`

#### **5. BotScripts (Сценарии бота)**

- `id` (PK)
- `name` - Название сценария
- `content` - Содержание сценария
- `created_at`
- `updated_at`

#### **6. Conversations (Переписки)**

- `id` (PK)
- `contact_id` (FK) - Ссылка на контакт
- `messenger_id` (FK) - Через какой мессенджер идет переписка
- `script_id` (FK) - Используемый сценарий
- `status` - Статус переписки (активна, завершена)
- `started_at`
- `ended_at`

#### **7. Messages (Сообщения)**

- `id` (PK)
- `conversation_id` (FK) - Ссылка на переписку
- `sender` - Отправитель (бот или клиент)
- `message_text` - Текст сообщения
- `timestamp`
- `is_ai_generated` - Флаг ИИ-сгенерированного сообщения

#### **8. Tasks (Задачи)**

- `id` (PK)
- `contact_id` (FK) - Ссылка на контакт
- `user_id` (FK) - Ссылка на менеджера
- `crm_id` (FK) - Ссылка на CRM систему
- `description` - Описание задачи
- `status` - Статус задачи
- `created_at`
- `updated_at`

#### **9. Integrations (Интеграции)**

- `id` (PK)
- `name` - Название интеграции
- `type` - Тип (CRM, мессенджер)
- `settings` - Настройки подключения
- `is_active`
- `created_at`
- `updated_at`

#### **10. Users (Пользователи)**

- `id` (PK)
- `name` - Имя пользователя
- `email`
- `role` - Роль (менеджер, администратор)
- `created_at`
- `updated_at`

---

### **Связи между таблицами:**

- **Contacts** имеет связь многие-к-одному с **Segments** и **ContactSources**.
- **Conversations** связана с **Contacts**, **Messengers** и **BotScripts**.
- **Messages** связана многие-к-одному с **Conversations**.
- **Tasks** связана с **Contacts**, **Users** и **Integrations**.
- **Integrations** используются в **ContactSources** и **Messengers**.

---

### **Пояснения по функциональности:**

- **Универсальность схемы:**
  - **Контакты** могут поступать из разных источников благодаря таблице **ContactSources**.
  - **Мессенджеры** хранятся в отдельной таблице, что позволяет легко добавлять новые.

- **Обработка контактов:**
  - **Contacts** содержит базовую информацию о клиентах.
  - **Segments** позволяют группировать контакты для таргетированных кампаний.

- **Переписка с клиентами:**
  - **Conversations** отслеживает каждую сессию общения.
  - **Messages** хранит историю сообщений, включая флаг `is_ai_generated` для ИИ-сообщений.

- **Интеграции с CRM и мессенджерами:**
  - Таблица **Integrations** управляет настройками для внешних систем.

- **Создание задач для менеджеров:**
  - При выявлении интереса у клиента создается **Task**, которая может быть передана в CRM через интеграцию.

---